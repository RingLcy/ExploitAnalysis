# 调试常用断点
1. bu vbscript!VbsIsEmpty ".printf \"VbsIsEmpty Output:\\n\"; .if(wo(poi(esp+c))== 8) {du poi((poi(esp+c)+8))} .else {dd poi(esp+c)}"
2. bu vbscript!CScriptRuntime::RunNoEH "!py C:\\tools\\kl_vbs_disasm_windbg.py"


# VBScript 数据结构
## 1. VarType
|Constant|Value|Description|
| :------: | :------: | :------: |
|vbEmpty|0|Empty (uninitialized)|
|vbNull|1|Null (no valid data)|
|vbInteger|2|Integer|
|vbLong|3|Long integer|
|vbSingle|4|Single-precision floating-point number|
|vbDouble|5|Double-precision floating-point number|
|vbCurrency|6|Currency value|
|vbDate|7|Date value|
|vbString|8|String|
|vbObject|9|Object|
|vbError |10|Error value|
|vbBoolean|11|Boolean value|
|vbVariant|12|Variant (used only with arrays of variants)|
|vbDataObject|13|A data access object|
|vbDecimal|14|Decimal value|
|vbByte|17|Byte value|
|vbUserDefinedType|36|Variants that contain user-defined types|
|VT_FUNC|76（0x4c）|
|vbArray|0x2000|Array|
|VT_BYREF|0x4000|
|VT_RESERVED|0x8000|


## 1. VBScriptClass
```
<script LANGUAGE="VBScript">
Dim X
Class TestClass
    Dim a,b
    
    Private Sub Class_Initialize   
        a=&h1122334
        b="test string"
    End Sub
    Private Sub Class_Terminate   
    End Sub
    
    Sub test_fun
        test_fun=1
    End Sub
    
End Class
Set X = New TestClass
IsEmpty(X)

</script>
```

![](VbscriptBasics/VbscriptBasics0.png)

调试过程如下：

![](VbscriptBasics/VbscriptBasics2.png)
![](VbscriptBasics/VbscriptBasics3.png)
![](VbscriptBasics/VbscriptBasics4.png)

# 参考
https://hk.saowen.com/a/cb8011f66d4d2d723d9a95094c5432db0e3e75f2481341690342f1028f9c9ea0